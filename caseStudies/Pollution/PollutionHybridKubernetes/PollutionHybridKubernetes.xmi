<?xml version="1.0" encoding="UTF-8"?>
<pasys:ComputationalSystem
    xmi:version="2.0"
    xmlns:xmi="http://www.omg.org/XMI"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:pasys="www.unican.es/ISTR/P3forI4/pasys"
    xsi:schemaLocation="www.unican.es/ISTR/P3forI4/pasys ../../../metamodels/PABM_Metamodel.ecore#//pasys"
    name="SantanderPollution"
    date="20/11/2019"
    authors="P. López y R. Dintén">
  <ownedElements
      xsi:type="pasys:PhysicalProcessingNode"
      name="KafkaNode"
      id="KafkaNode"
      ip="123.456.789.191"
      userName="gestor"/>
  <ownedElements
      xsi:type="pasys:PhysicalProcessingNode"
      name="ZkprNode"
      id="ZkprNode"
      ip="123.456.789.191"
      userName="gestor"/>
  <ownedElements
      xsi:type="pasys:AWSVirtualProcessingNode"
      name="KubernetesNode"
      id="KubernetesNode"
      ip="172.31.26.169"
      memorySize="2048"
      userName="gestor"
      externalIP="34.248.160.67"
      vpc="default"
      subNet="eu-west-a"
      keyPair=""
      securityGroup="IAP_SecurityGroup"
      AMI="IAP4.0_AMI"
      instanceType="t2.small"/>
  <ownedElements
      xsi:type="pasys:NodeCluster"
      name="KafkaCluster"
      id="KafkaCluster"
      resources="//@ownedElements.0"/>
  <ownedElements
      xsi:type="pasys:NodeCluster"
      name="ZookeeperCluster"
      id="ZookeeperCluster"
      resources="//@ownedElements.1"/>
  <ownedElements
      xsi:type="pasys:NodeCluster"
      name="KubernetesCluster"
      id="KubernetesCluster"
      resources="//@ownedElements.2"/>
  <ownedElements
      xsi:type="pasys:ZookeeperService"
      name="PollutionZkpr"
      id="PollutionZkpr"
      host="//@ownedElements.4">
    <deploymentConfig
        xsi:type="pasys:NodeClusterDeploymentConf"
        artifactLocator="/home/gestor/apache/Services/zookeeper/bin"
        artifactName="zkService.sh"
        configFolderPath="/home/gestor/apache/Services/zookeeper/config"
        scriptFolderPath="/home/gestor/apache/Services/zookeeper/scripts"
        dataFolderPath="/home/gestor/apache/Services/zookeeper/data"
        logFolderPath="/home/gestor/apache/Services/zookeeper/logs"/>
  </ownedElements>
  <ownedElements
      xsi:type="pasys:KafkaService"
      name="PollutionKafka"
      id="PollutionKafka"
      host="//@ownedElements.3"
      commId="1"
      clientPort="9092"
      zookeeperConnect="//@ownedElements.6"
      listeners="PLAINTEXT://172.31.21.96:9092"
      advertisedListeners="PLAINTEXT://172.31.21.96:9092"
      autoCreateTopicEnable="true">
    <deploymentConfig
        xsi:type="pasys:NodeClusterDeploymentConf"
        artifactLocator="/home/gestor/apache/services/kafka/bin"
        artifactName="kafka-Service-start.sh"
        configFolderPath="/home/gestor/apache/Services/kafka/config"
        scriptFolderPath="/home/gestor/apache/services/kafka/scripts"
        dataFolderPath="/home/gestor/apache/Services/kafka/data"
        logFolderPath="/home/gestor/apache/Services/kafka/logs"/>
  </ownedElements>
  <ownedElements
      xsi:type="pasys:CassandraService"
      name="PollutionCassandra"
      id="PollutionCassandra"
      orchestrator="//@ownedElements.12"
      logging="root"
      passwd="root"
      port="9042"
      seedProviderClass="SimpleSeedProvider"
      dataFileDir="/home/gestor/apache/Services/cassandra/data/data">
    <deploymentConfig
        xsi:type="pasys:OrchestrationServiceDeploymentConf"
        image="cassandra-rai:3.0"
        replicas="2"
        command="/bin/sh"
        imagePullPolicy="IFNOTPRESENT">
      <volumes
          source="/home/gestor/apache/cassandra/conf"
          target="/home/gestor/apache/cassandra/conf"
          type="BIND"/>
      <volumes
          source="/home/gestor/apache/cassandra/logs"
          target="&quot;/var/log/cassandra&quot;"
          type="BIND"/>
    </deploymentConfig>
    <cqlSchemas
        filePath="/home/algorrim/Escritorio/Ricardo/git/PASYSDeploymentTool"
        fileName="cassandra_schema.sql"/>
    <dataCenters
        name="pollutionCluster"
        id="pollutionCluster">
      <racks
          name="PollutionCluster"
          id="PollutionClusterRack"/>
    </dataCenters>
  </ownedElements>
  <ownedElements
      xsi:type="pasys:StormService"
      name="PollutionStorm"
      id="PollutionStorm"
      orchestrator="//@ownedElements.12"
      workflows="//@ownedElements.11"
      zookeeperConnect="//@ownedElements.6">
    <deploymentConfig
        xsi:type="pasys:OrchestrationServiceDeploymentConf"
        image=""
        replicas="1">
      <volumes
          source="/home/gestor/apache/servers/storm/conf"
          target="/home/gestor/apache/servers/storm/conf"
          type="BIND"/>
      <volumes
          source="/home/gestor/apache/servers/storm/logs"
          target="/home/gestor/apache/servers/storm/logs"
          type="BIND"/>
      <ports
          xsi:type="pasys:SwarmPort"
          target="6627"
          published="6627"/>
    </deploymentConfig>
    <nimbus
        name="PolllutionStormNimbus"
        id="PolllutionStormNimbus">
      <deploymentConfig
          xsi:type="pasys:OrchestrationServiceDeploymentConf"/>
    </nimbus>
    <supervisor
        name="PolllutionStormSupervisor"
        id="PolllutionStormSupervisor">
      <deploymentConfig
          xsi:type="pasys:OrchestrationServiceDeploymentConf"/>
    </supervisor>
    <ui name="PollutionStormUI"
        id="PollutionStormUI">
      <deploymentConfig
          xsi:type="pasys:OrchestrationServiceDeploymentConf"/>
    </ui>
  </ownedElements>
  <ownedElements
      xsi:type="pasys:KafkaWorkloadStreamData"
      name="Pollution"
      id="Pollution"
      numPartitions="1"
      numReplication="1"
      holder="1">
    <deploymentConfig
        xsi:type="pasys:NodeClusterDeploymentConf"
        artifactLocator="/home/gestor/apache/services/kafka/bin"
        artifactName="kafka-topics.sh"
        configFolderPath="/home/gestor/apache/apps/pollution/topics/config"
        scriptFolderPath="/home/gestor/apache/apps/pollution/topics/scripts"
        dataFolderPath="/home/gestor/apache/apps/pollution/topics/data"
        logFolderPath="/home/gestor/apache/apps/pollution/topics/log"/>
  </ownedElements>
  <ownedElements
      xsi:type="pasys:Workflow"
      name="PollutionProcess"
      id="PollutionProcess"
      rootTask="//@ownedElements.11/@ownedTasks.0"
      scheduler="//@ownedElements.9">
    <deploymentConfig
        xsi:type="pasys:NodeClusterDeploymentConf"
        artifactLocator="/home/gestor/apache/apps/pollution/workflows/jars"
        artifactName="SantanderPollution.jar"
        configFolderPath="/home/gestor/apache/apps/pollution/workflows/config"
        scriptFolderPath="/home/gestor/apache/apps/pollution/workflows/scripts"
        dataFolderPath="/home/gestor/apache/apps/pollution/workflows/data"
        logFolderPath="/home/gestor/apache/apps/pollution/workflows/logs"/>
    <ownedTasks
        name="MainTask"
        id="MainTask"
        implementingClassName="es.unican.dintenr.santanderPollution.SantanderPollutionTopology"
        triggerStreamData="//@ownedElements.10"
        inputStreamData="//@ownedElements.10"/>
  </ownedElements>
  <ownedElements
      xsi:type="pasys:KubernetesService"
      name="PollutionKubernetes"
      id="PollutionKubernetes"
      host="//@ownedElements.5"
      services="//@ownedElements.8 //@ownedElements.9">
    <deploymentConfig
        xsi:type="pasys:NodeClusterDeploymentConf"/>
  </ownedElements>
  <authenticationFiles
      key="34.255.137.20"
      value="/home/algorrim/ISTR_keypair.pem"/>
  <authenticationFiles
      key="3.248.207.185"
      value="/home/algorrim/ISTR_keypair.pem"/>
  <authenticationFiles
      key="54.194.37.254"
      value="/home/algorrim/ISTR_keypair.pem"/>
  <authenticationFiles
      key="54.194.247.222"
      value="/home/algorrim/ISTR_keypair.pem"/>
  <authenticationFiles
      key="34.248.160.67"
      value="/home/algorrim/ISTR_keypair.pem"/>
</pasys:ComputationalSystem>
